<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet"/>
  <style>
    .table td, .table th {
      vertical-align: middle;
    }
  </style>
</head>
<body class="bg-light">
  <div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2>üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</h2>
      <a href="indexdemo.html" class="btn btn-secondary"><i class="bi bi-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö</a>
    </div>

    <table class="table table-bordered bg-white shadow-sm">
      <thead class="table-light">
        <tr>
          <th>#</th>
          <th>‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏¥‡∏ï</th>
          <th>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô</th>
          <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
          <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
          <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
        </tr>
      </thead>
      <tbody id="logs-table">
        <tr>
          <td colspan="6" class="text-center text-danger">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Bootstrap JS (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô script ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- JS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
  <script>
    async function fetchLogs() {
      const table = document.getElementById("logs-table");
      try {
        const res = await fetch("data/get_data.php");
        const json = await res.json();
        table.innerHTML = "";

        if (json.status === "success" && json.data.length > 0) {
          json.data.forEach((log, index) => {
            const row = document.createElement("tr");
            row.innerHTML = `
              <td>${index + 1}</td>
              <td>‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà-${log.job_number}</td>
              <td>${log.number}</td>
              <td>${new Date(log.timestamp).toLocaleString("th-TH")}</td>
              <td>
                <span class="badge ${log.status === 'start' ? 'bg-success' : 'bg-danger'}">
                  ${log.status === 'start' ? '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô' : '‡∏´‡∏¢‡∏∏‡∏î‡∏á‡∏≤‡∏ô'}
                </span>
              </td>
              <td><button class="btn btn-sm btn-outline-secondary" disabled>‚Äî</button></td>
            `;
            table.appendChild(row);
          });
        } else {
          table.innerHTML = `<tr><td colspan="6" class="text-center text-danger">‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>`;
        }
      } catch (error) {
        console.error("‡πÇ‡∏´‡∏•‡∏î log ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:", error);
        table.innerHTML = `<tr><td colspan="6" class="text-center text-danger">‚ùå ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</td></tr>`;
      }
    }

    document.addEventListener("DOMContentLoaded", fetchLogs);
  </script>
</body>
</html>
